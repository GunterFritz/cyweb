{% block extrahead %}
{% endblock %}
{% block javascript %}
<script>
  function updateMembers(json){
    var obj = $.parseJSON(json);
    $.each(obj.member , function(index, val) {
	console.log(val.id);
	if(val.status){
	    console.log("True");
            $( "#_member_" + val.id + "_icon").text('check');
	} else {
	    console.log("False");
            $( "#_member_" + val.id + "_icon").text('remove');
	}
    });
  }
  function getMembers(){
    $.ajax({
        type: "GET",
        url: '{% url 'cyka:get_json_members' project.id %}',
	complete: function (response) {
          updateMembers(response.responseText)
      }
    });
  }
  function refreshMembers(){
    tmp = setInterval(function() {
	getMembers();
    }, 3000);
    refreshs.push(tmp);
  }
  $(document).ready(function(){
    small();
    //refreshMembers();
    $('.tooltipped').tooltip({enterDelay: 1000});
  });
    function resolve(){
	if (confirm("Möchten Sie die Themen Zuteilung auflösen?")){
	    aurl('{% url 'cyka:moderator_priorization' project.id %}?function=resolve');
	}
    }
</script>
{% endblock %}
<div class="col actionarea" style="overflow: hidden">
      <div class="row" style="padding-top: 1px;">
        <ul class="pagination center">
          <li class="waves-effect disabled"><a href="#!">Brainwriting</a></li>
          <li class="waves-effect disabled"><a href="#!">Themenvorschlag</a></li>
          <li class="waves-effect disabled"><a href="#!">Themenwahl</a></li>
          <li class="waves-effect active blue"><a href="#!">Priorisierung</a></li>
          </ul>
      </div>
      <div class="row center" style="padding-bottom: 10px;">
        <a onmouseover="this.style.cursor='pointer'" onclick="aurl('{% url 'cyka:moderator_topicauction' project.id %}?function=table')"
		class="waves-effect waves-light btn-floating blue {% if step.status != 'O' %}disabled{% endif%}"><i class="material-icons tooltipped" data-tooltip="Schritt zurücksetzen">fast_rewind</i>
	</a>
	<a onmouseover="this.style.cursor='pointer'" onclick="submit('O','{% url 'cyka:moderator_priorization' project.id %}', '{{step.step}}')"
	     class="waves-effect waves-light btn-floating blue {% if step.status == 'O' %}disabled{% endif%}">
		<i class="material-icons tooltipped" data-tooltip="Starten">replay</i>
        </a>
	<a onmouseover="this.style.cursor='pointer'" onclick="submit('S','{% url 'cyka:moderator_priorization' project.id %}', '{{step.step}}')"
	     class="waves-effect waves-light btn-floating blue {% if step.status != 'O' %}disabled{% endif%}"><i class="material-icons tooltipped" data-tooltip="Starten">play_arrow</i>
        </a>
        <a onmouseover="this.style.cursor='pointer'" onclick="submit('B','{% url 'cyka:moderator_priorization' project.id %}', '{{step.step}}')"
	     class="waves-effect waves-light btn-floating blue {% if step.status != 'S' %}disabled{% endif%}"><i class="material-icons tooltipped" data-tooltip="Stoppen">stop</i>
        </a>
        <a onmouseover="this.style.cursor='pointer'" onclick="aurl('{% url 'cyka:moderator_priorization' project.id %}?function=agenda')"
	     class="waves-effect waves-light btn-floating blue {% if step.status != 'B' or not project.hasagenda %}disabled{% endif%}"><i class="material-icons tooltipped" data-tooltip="nächster Schritt">fast_forward</i></a>
      </div>
      <div class="card">
        <div class="collection">
          {% for m in member %}
	  <a class="collection-item" id="_member_{{m.id}}" onmouseover="this.style.cursor='pointer'" onclick="aurl('{% url 'cyka:moderator_priorization' project.id %}?function=details&member={{m.id}}')"><div>
		  <span id="_member_{{m.id}}_name" class="icon-black">{{m.name}}</span>
		  <span class="secondary-content">
			  <i id="_member_{{m.id}}_icon" class="material-icons icon-text icon-blue">{% if m.status %}check{% else %}remove{% endif %}</i>
		  </span>
	  </div></a>
	  {% endfor %}
        </div>
	<div class="card-action">
		<a class="btn blue{% if project.hasagenda %} disabled{% endif %}" onclick="aurl('{% url 'cyka:moderator_priorization' project.id %}?function=assign')">Themen Zuteilen</a>
		<a class="btn blue{% if not project.hasagenda %} disabled{% endif %}" onclick="resolve()">Zuteilung löschen</a>
        </div>
      </div>
</div>
