{% load material_form %}
{% block extrahead %}
{% endblock %}
{% block javascript %}
<script>
  $(document).ready(function(){
    small();
	  console.log("Id: {{form.cardid.value}}");
    $('.tooltipped').tooltip({enterDelay: 1000});
  });
  function submit(del){
    $.ajax({
        type: "POST",
        url: '{% url 'cyka:personal_card' member.uuid %}?project={{project.id}}',
        data:{
	      delete:del,
              heading:$('#id_heading').val(),
              desc:$('#id_desc').val(),
              cardid:$('#id_cardid').val(),
              csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
              action: 'post'
        },
    })
      .done(function(response) {
          $('#_appendHere').html(response);
      });
    }

function delete_card(){
	if (confirm("Möchten Sie die Karte löschen?")){
		submit('true');
	}
  }
</script>
</script>
{% endblock %}
<div class="headcontainer">
    <div class="col actionarea">
      {% if not step.done and not all %}
      <div class="card-panel mplanopen">
        <dmc-form><form method="POST" enctype="multipart/form-data" id="post-form">
            <div class="card-content">
                {% csrf_token %}
                {% block formbody %}
                    <div class="right-align">
                        {% form %}
                        {% endform %}
                    </div>
                {% endblock %}
            </div>
        </form></dmc-form>
            <div class="card-action right-align">
		    {% if form.cardid.value != NONE and form.cardid.value != "" %}
		    <span onclick="return delete_card();">
			<button class="btn modal-action modal-close btn-primary blue" type="submit">Löschen</button>
		    </span>
		    <button onclick="submit('false')" class="btn modal-action modal-close btn-primary blue">OK</button>
		    {% else %}
		    <button onclick="submit('false')" class="btn modal-action modal-close btn-primary blue">Neu</button>
		    {% endif %}
            </div>
      </div>
            {% endif %}
      <div class="cardcontainer">
        {% for card in cards %}
            {% if step.done or all %}
	    <div class="item card-panel mplanopen blue lighten-5">
            {% else %}
	    <div class="item card-panel mplanopen tooltipped blue lighten-5" onmouseover="this.style.cursor='pointer'" onclick="aurl('{% url 'cyka:personal_card' member.uuid %}?project={{project.id}}&card={{card.id}}')" data-tooltip="Bearbeiten">
            {% endif %}
		    <span class="black-text card-title" STYLE="font-size:16px">{{card.heading}}</span><br/>
		    <span class="grey-text text-darken-2">{{card.desc}}</span>
            </div>
	{% endfor %}
      </div>
    </div>
    <div class="col right navarea">
        <div class="row">
	    <a class="btn-floating btn-large blue right" onclick="get_agenda()"><i class="right material-icons tooltipped" data-tooltip="Agenda">menu</i></a>
        </div>
        <div class="row">
            <a class="btn-floating btn-large waves-effect waves-light right blue" onclick="resize()"><i class="left material-icons secondary-content">code</i></a>
        </div>
        <div class="row">
	    <a  onclick="aurl('{% url 'cyka:personal_card' member.uuid %}')" class="btn-floating btn-large blue right {% if not all %}disabled{% endif %}"><i class="material-icons tooltipped" data-tooltip="Nur meine anzeigen">perm_identity</i></a>
        </div>
        <div class="row">
	    <a  onclick="aurl('{% url 'cyka:personal_card' member.uuid %}?cards=all')" class="btn-floating btn-large blue right {% if all %}disabled{% endif %}"><i class="material-icons tooltipped" data-tooltip="Alle anzeigen">people_outline</i></a>
        </div>
    </div>
</div>
