{% extends 'cyka/personal_base.html' %}
{% block extrahead %}
<style type="text/css">
  @media only screen and (min-width : 601px) {
      #id_card_type_container {
          margin-top: 40px;
          margin-left: 50px;
      }
      }
      .groups {
	  width:25%
      }
      .wbut {
	  width:100%
      }
      .meet {
	  width:75%
      }
      .fullh {
        height: 100%
      }
      .derow .decol {
        border: 1px dotted #0313fc
      }
</style>
{% endblock %}
{% block javascript %}
<script src="https://meet.cyiko.org/external_api.js"></script>
<script>
  var interval = null;
  function refreshSupporter(){
    interval = setInterval(function() {
	aurl('{% url 'cyka:personal_join_table' member.uuid %}?table={{table.id}}&function=supporter', '#_supporter')
    }, 3000);
  }
  $(document).ready(function(){
    small();
    var container = document.querySelector('#jitsi-container');
    var domain = "{{jitsi.domain}}";
    var options = {
	roomName: "{{jitsi.room}}",
        height: 700,
        parentNode: container,
    };
    var api = new JitsiMeetExternalAPI(domain, options);
    api.executeCommand ('displayName', '{{jitsi.name}}'); 
    api.executeCommand ('subject', '{{jitsi.subject}}');
    aurl('{% url 'cyka:personal_join_table' member.uuid %}?table={{table.id}}&function=pad', '#_padArea');
    $('.tooltipped').tooltip({enterDelay: 1000});
    refreshSupporter();
    });
    //resize
    var size = 0;
    function small() {
        $("#meetcontent").outerWidth('25%');
        $("#stepcontent").outerWidth('75%');
        size = 1;
    } 
    function big() {
        $("#meetcontent").outerWidth('75%');
        $("#stepcontent").outerWidth('25%');
	size = 0;
    }
    function resize() {
	if (size == 0) {
	    small();
	} else {
	    big();
	}
    }
    function aurl(myurl, where) {
        $.ajax({
            type: "GET",
		url: myurl,
        })
        .done(function(response) {
            $(where).html(response);
        }); 
    }
    function leave(url){
        clearInterval(interval);
        window.location.href = url;
    }   
</script>
{% endblock %}
{% block content %}
<div class="row">
    <div id="meetcontent" class="col meet">
        <div id="jitsi-container">
        </div>
    </div>
    <div id="stepcontent" class="col headcontainer">
        <div class="col actionarea">
            <div id="_padArea" class="row">
            </div>
        </div>
        <div class="col navarea right">
            <div class="row">
	        <a class="btn-floating btn-large red right" onclick="leave('{% url 'cyka:personal_workflow' member.uuid %}?start=table&project={{project.uuid}}')"><i class="right material-icons tooltipped" data-tooltip="Verlassen">exit_to_app</i></a>
            </div>
            <div class="row">
                <a class="btn-floating btn-large waves-effect waves-light right blue" onclick="resize()"><i class="left material-icons secondary-content">code</i></a>
            </div>
            <div class="row">
		    <a id="_thumbButton" onclick="aurl('{% url 'cyka:personal_join_table' member.uuid %}?table={{table.id}}&function=sign', '#_supporter')" class="btn-floating btn-large right blue"><i class="material-icons tooltipped" data-tooltip="Thema unterstÃ¼tzen">thumb_up</i></a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
